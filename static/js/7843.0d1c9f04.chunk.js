"use strict";(self.webpackChunkwebstory_editor_starter=self.webpackChunkwebstory_editor_starter||[]).push([[7843],{87843:(e,t,n)=>{n.r(t),n.d(t,{default:()=>xt});var o=n(65043),r=n(22697);function i(e){let{width:t,height:n}=e;return t/n}function a(e){const t=10**(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0);return Math.round((e+Number.EPSILON)*t)/t}class s{constructor(e){this.comparator=e,this.heap=[],this.n=0}greater(e,t){return this.comparator(this.heap[e],this.heap[t])<0}swap(e,t){const n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n}swim(e){let t=e,n=Math.floor(t/2);for(;t>1&&this.greater(n,t);)this.swap(n,t),t=n,n=Math.floor(t/2)}sink(e){let t=e,n=2*t;for(;n<=this.n&&(n<this.n&&this.greater(n,n+1)&&(n+=1),this.greater(t,n));)this.swap(t,n),t=n,n=2*t}push(e){this.n+=1,this.heap[this.n]=e,this.swim(this.n)}pop(){if(0===this.n)return;this.swap(1,this.n),this.n-=1;const e=this.heap.pop();return this.sink(1),e}size(){return this.n}}function l(e,t,n){const o=function(e,t,n){const o=new Map,r=new Set,i=new Map;i.set(t,0);const a=new s((l=e=>e.weight,(e,t)=>l(t)-l(e)));var l;for(a.push({id:t,weight:0});a.size()>0;){const{id:t,weight:n}=a.pop();if(!r.has(t)){const s=e(t);r.add(t),s.forEach(((e,r)=>{const s=n+e,l=o.get(r),c=i.get(r);(void 0===c||c>s&&(c/s>1.005||void 0!==l&&l<t))&&(i.set(r,s),a.push({id:r,weight:s}),o.set(r,t))}))}}return i.has(n)?o:void 0}(e,t,n);return o?function(e,t){const n=[];for(let o=t;void 0!==o;o=e.get(o))n.push(o);return n.reverse()}(o,n):void 0}function c(e,t,n,o){return(t-(e.length-1)*n-2*o*e.length)/e.reduce(((e,t)=>e+i(t)),0)}function u(e,t,n,o,r,i,a){const s=e.slice(t,n),l=c(s,o,i,a);return l>0?(l-r)**2*s.length:void 0}function d(e){let{photos:t,layoutOptions:n}=e;const{spacing:o,padding:r,containerWidth:s,targetRowHeight:d,rowConstraints:p}=n,h=function(e){let{photos:t,targetRowHeight:n,containerWidth:o}=e;return a(o/n/t.reduce(((e,t)=>Math.min(i(t),e)),Number.MAX_VALUE))+2}({photos:t,containerWidth:s,targetRowHeight:d}),m=function(e){let{photos:t,layoutOptions:n,targetRowHeight:o,limitNodeSearch:r,rowConstraints:i}=e;return e=>{var a,s;const{containerWidth:l,spacing:c,padding:d}=n,p=new Map;p.set(e,0);const h=null!=(a=null==i?void 0:i.minPhotos)?a:1,m=Math.min(r,null!=(s=null==i?void 0:i.maxPhotos)?s:1/0);for(let n=e+h;n<t.length+1&&!(n-e>m);n+=1){const r=u(t,e,n,l,o,c,d);if(void 0===r)break;p.set(n,r)}return p}}({photos:t,layoutOptions:n,targetRowHeight:d,limitNodeSearch:h,rowConstraints:p}),g=l(m,0,t.length);if(void 0===g)return;const y=[];for(let a=1;a<g.length;a+=1){const e=t.map(((e,t)=>({photo:e,index:t}))).slice(g[a-1],g[a]),n=c(e.map((e=>{let{photo:t}=e;return t})),s,o,r);y.push(e.map(((t,o)=>{let{photo:r,index:a}=t;return{photo:r,layout:{height:n,width:n*i(r),index:a,photoIndex:o,photosCount:e.length}}})))}return y}function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[...t].filter((e=>Boolean(e))).join(" ")}function h(e,t,n){const{width:o,photosCount:r}=t,{layout:i,spacing:s,padding:l,containerWidth:c}=n,u="rows"===i?r:n.columns,d=s*(u-1)+2*l*u;return`calc((${e} - ${d}px) / ${a((c-d)/o,5)})`}function m(e,t){return"rows"!==t.layout?`calc(100% - ${2*t.padding}px)`:h("100%",e,t)}function g(e,t,n){var o,r;return h(null!=(r=null==(o=e.match(/^\s*calc\((.*)\)\s*$/))?void 0:o[1])?r:e,t,n)}function y(e,t,n){var o;let r,i;const a=e.srcSet||e.images;return a&&a.length>0&&(r=a.concat(a.find((t=>{let{width:n}=t;return n===e.width}))?[]:[{src:e.src,width:e.width,height:e.height}]).sort(((e,t)=>e.width-t.width)).map((e=>`${e.src} ${e.width}w`)).join(", ")),i=(null==(o=n.sizes)?void 0:o.size)?(n.sizes.sizes||[]).map((e=>{let{viewport:o,size:r}=e;return`${o} ${g(r,t,n)}`})).concat(g(n.sizes.size,t,n)).join(", "):`${Math.ceil(t.width/n.containerWidth*100)}vw`,{srcSet:r,sizes:i}}function f(e){var t,n;const{photo:r,layout:i,layoutOptions:a,imageProps:{style:s,className:l,...c}={},renderPhoto:u}=e,{onClick:d}=a,h={display:"block",boxSizing:"content-box",width:m(i,a),height:"auto",aspectRatio:`${r.width} / ${r.height}`,...a.padding?{padding:`${a.padding}px`}:null,...("columns"===a.layout||"masonry"===a.layout)&&i.photoIndex<i.photosCount-1?{marginBottom:`${a.spacing}px`}:null,...d?{cursor:"pointer"}:null,...s},g=d?e=>{d({event:e,photo:r,index:i.index})}:void 0,f={src:r.src,alt:null!=(t=r.alt)?t:"",title:r.title,onClick:g,style:h,className:p("react-photo-album--photo",l),loading:"lazy",decoding:"async",...y(r,i,a),...c},w=e=>{const{src:t,alt:n,srcSet:r,sizes:i,style:a,...s}=f;return o.createElement("img",{alt:n,...r?{srcSet:r,sizes:i}:null,src:t,style:(null==e?void 0:e.wrapped)?{display:"block",width:"100%",height:"100%"}:a,...s})},b=(e=>{let{display:t,boxSizing:n,width:o,aspectRatio:r,padding:i,marginBottom:a,cursor:s}=e;return{display:t,boxSizing:n,width:o,aspectRatio:r,padding:i,marginBottom:a,cursor:s}})(h);return o.createElement(o.Fragment,null,null!=(n=null==u?void 0:u({photo:r,layout:i,layoutOptions:a,imageProps:f,renderDefaultPhoto:w,wrapperStyle:b}))?n:w())}function w(e){let{rowContainerProps:t,children:n}=e;return o.createElement("div",{...t},n)}function b(e){const{layoutOptions:t,rowIndex:n,rowsCount:r,renderRowContainer:i,rowContainerProps:{style:a,className:s,...l}={},children:c}=e,u={className:p("react-photo-album--row",s),style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"flex-start",justifyContent:"space-between",...n<r-1?{marginBottom:`${t.spacing}px`}:null,...a},...l};return o.createElement(o.Fragment,null,(null!=i?i:w)({layoutOptions:t,rowIndex:n,rowsCount:r,rowContainerProps:u,children:c}))}function C(e){const{photos:t,layoutOptions:n,renderPhoto:r,renderRowContainer:i,componentsProps:{imageProps:a,rowContainerProps:s}}=e,l=d({photos:t,layoutOptions:n});return l?o.createElement(o.Fragment,null,l.map(((e,t)=>o.createElement(b,{key:`row-${t}`,layoutOptions:n,rowIndex:t,rowsCount:l.length,renderRowContainer:i,rowContainerProps:s},e.map((e=>{let{photo:t,layout:i}=e;return o.createElement(f,{key:t.key||t.src,photo:t,layout:i,layoutOptions:n,renderPhoto:r,imageProps:a})})))))):null}function E(e,t,n,o){return function(e,t,n){const o=[n];for(let r=n,i=t;i>0;i-=1)r=e.get(r)[i].node,o.push(r);return o.reverse()}(function(e,t,n,o){const r=new Map,i=new Set;i.add(n);for(let a=0;a<t;a+=1){const n=[...i.keys()];i.clear(),n.forEach((n=>{const s=a>0?r.get(n)[a].weight:0;e(n).forEach((e=>{let{neighbor:l,weight:c}=e,u=r.get(l);u||(u=[],r.set(l,u));const d=s+c,p=u[a+1];(!p||p.weight>d&&(p.weight/d>1.0001||n<p.node))&&(u[a+1]={node:n,weight:d}),a<t-1&&l!==o&&i.add(l)}))}))}return r}(e,t,n,o),t,o)}function x(e){let{path:t,photos:n,containerWidth:o,columnsGaps:r,columnsRatios:a,spacing:s,padding:l}=e;const c=[],u=a.reduce(((e,t)=>e+t),0);for(let d=0;d<t.length-1;d+=1){const e=n.map(((e,t)=>({photo:e,index:t}))).slice(t[d],t[d+1]),p=a.reduce(((e,t,n)=>e+(r[d]-r[n])*t),0),h=(o-(t.length-2)*s-2*(t.length-1)*l-p)*a[d]/u;c.push(e.map(((t,n)=>{let{photo:o,index:r}=t;return{photo:o,layout:{width:h,height:h/i(o),index:r,photoIndex:n,photosCount:e.length}}})))}return c}function v(e){let{photos:t,layoutOptions:n,targetColumnWidth:o}=e;const{columns:r,spacing:a,padding:s,containerWidth:l}=n,c=[],u=[];if(t.length<=r){const e=t.length>0?t.reduce(((e,t)=>e+i(t)),0)/t.length:1;for(let n=0;n<r;n+=1)c[n]=2*s,u[n]=n<t.length?i(t[n]):e;return{columnsGaps:c,columnsRatios:u,columnsModel:x({path:Array.from({length:r+1}).map(((e,n)=>Math.min(n,t.length))),photos:t,columnsRatios:u,columnsGaps:c,containerWidth:l,spacing:a,padding:s})}}const d=(t.reduce(((e,t)=>e+o/i(t)),0)+a*(t.length-r)+2*s*t.length)/r,p=function(e){let{photos:t,spacing:n,padding:o,targetColumnWidth:r,targetColumnHeight:a}=e;return e=>{const s=[],l=1.5*a;let c=r/i(t[e])+2*o;for(let u=e+1;u<t.length+1&&(s.push({neighbor:u,weight:(a-c)**2}),!(c>l||u===t.length));u+=1)c+=r/i(t[u])+n+2*o;return s}}({photos:t,targetColumnWidth:o,targetColumnHeight:d,spacing:a,padding:s}),h=E(p,r,0,t.length);for(let m=0;m<h.length-1;m+=1){const e=t.slice(h[m],h[m+1]);c[m]=a*(e.length-1)+2*s*e.length,u[m]=1/e.reduce(((e,t)=>e+1/i(t)),0)}return{columnsGaps:c,columnsRatios:u,columnsModel:x({path:h,photos:t,columnsRatios:u,columnsGaps:c,containerWidth:l,spacing:a,padding:s})}}function _(e){const{photos:t,layoutOptions:n}=e,{columns:o,spacing:r,padding:i,containerWidth:a}=n,s=(a-r*(o-1)-2*i*o)/o,{columnsGaps:l,columnsRatios:c,columnsModel:u}=v({photos:t,layoutOptions:n,targetColumnWidth:s});return u.findIndex((e=>e.findIndex((e=>{let{layout:{width:t,height:n}}=e;return t<0||n<0}))>=0))>=0?o>1?_({photos:t,layoutOptions:{...n,columns:o-1}}):void 0:{columnsModel:u,columnsGaps:l,columnsRatios:c}}function k(e){let{photos:t,layoutOptions:n}=e;return _({photos:t,layoutOptions:n})}function A(e){let{columnContainerProps:t,children:n}=e;return o.createElement("div",{...t},n)}function I(e){const{layoutOptions:t,columnIndex:n,columnsCount:o,columnsGaps:r,columnsRatios:i}=e,{layout:s,spacing:l,padding:c}=t;if("masonry"===s||!r||!i)return`calc((100% - ${l*(o-1)}px) / ${o})`;const u=i.reduce(((e,t)=>e+t),0);return`calc((100% - ${a((o-1)*l+2*o*c+i.reduce(((e,t,o)=>e+(r[n]-r[o])*t),0),3)}px) * ${a(i[n]/u,5)} + ${2*c}px)`}function P(e){const{layoutOptions:t,renderColumnContainer:n,children:r,columnContainerProps:{style:i,className:a,...s}={},...l}=e,c={className:p("react-photo-album--column",a),style:{display:"flex",flexDirection:"column",flexWrap:"nowrap",alignItems:"flex-start",width:I(e),justifyContent:"columns"===t.layout?"space-between":"flex-start",...i},...s};return o.createElement(o.Fragment,null,(null!=n?n:A)({layoutOptions:t,columnContainerProps:c,children:r,...l}))}function M(e){const{photos:t,layoutOptions:n,renderPhoto:r,renderColumnContainer:i,componentsProps:{imageProps:a,columnContainerProps:s}}=e,l=k({photos:t,layoutOptions:n});if(!l)return null;const{columnsModel:c,columnsRatios:u,columnsGaps:d}=l;return o.createElement(o.Fragment,null,c.map(((e,t)=>o.createElement(P,{key:`column-${t}`,layoutOptions:n,columnIndex:t,columnsCount:c.length,columnsGaps:d,columnsRatios:u,renderColumnContainer:i,columnContainerProps:s},e.map((e=>{let{photo:t,layout:i}=e;return o.createElement(f,{key:t.key||t.src,photo:t,layout:i,layoutOptions:n,renderPhoto:r,imageProps:a})}))))))}function R(e){const{photos:t,layoutOptions:n}=e,{columns:o,spacing:r,padding:a,containerWidth:s}=n,l=(s-r*(o-1)-2*a*o)/o;if(l<=0)return o>1?R({...e,layoutOptions:{...n,columns:o-1}}):void 0;const c=[];for(let i=0;i<o;i+=1)c[i]=0;return t.reduce(((e,t,n)=>{const o=c.reduce(((e,t,n)=>t<c[e]-1?n:e),0);return c[o]=c[o]+l/i(t)+r+2*a,e[o].push({photo:t,index:n}),e}),Array.from({length:o}).map((()=>[]))).map((e=>e.map(((t,n)=>{let{photo:o,index:r}=t;return{photo:o,layout:{width:l,height:l/i(o),index:r,photoIndex:n,photosCount:e.length}}}))))}function O(e){const{photos:t,layoutOptions:n,renderPhoto:r,renderColumnContainer:i,componentsProps:{imageProps:a,columnContainerProps:s}}=e,l=R({photos:t,layoutOptions:n});return l?o.createElement(o.Fragment,null,l.map(((e,t)=>o.createElement(P,{key:`masonry-column-${t}`,layoutOptions:n,columnsCount:l.length,columnIndex:t,renderColumnContainer:i,columnContainerProps:s},e.map((e=>{let{photo:t,layout:i}=e;return o.createElement(f,{key:t.key||t.src,photo:t,layout:i,layoutOptions:n,renderPhoto:r,imageProps:a})})))))):null}function W(e){let{containerProps:t,children:n,containerRef:r}=e;return o.createElement("div",{ref:r,...t},n)}function D(e){const{layout:t,renderContainer:n,children:r,containerRef:i,containerProps:{style:a,className:s,...l}={}}=e,c={className:p("react-photo-album",`react-photo-album--${t}`,s),style:{display:"flex",flexWrap:"nowrap",justifyContent:"space-between",flexDirection:"rows"===t?"column":"row",...a},...l};return o.createElement(o.Fragment,null,(null!=n?n:W)({containerProps:c,containerRef:i,layout:t,children:r}))}function $(e,t){let{newContainerWidth:n,newScrollbarWidth:o}=t;const{containerWidth:r,scrollbarWidth:i}=e;return void 0!==r&&void 0!==i&&void 0!==n&&void 0!==o&&n>r&&n-r<=20&&o<i?{containerWidth:r,scrollbarWidth:o}:r!==n||i!==o?{containerWidth:n,scrollbarWidth:o}:e}function S(e,t){let n=null==e?void 0:e.clientWidth;if(void 0!==n&&t&&t.length>0){const e=[...t.filter((e=>e>0))].sort(((e,t)=>t-e));e.push(Math.floor(e[e.length-1]/2));const o=n;n=e.find(((t,n)=>t<=o||n===e.length-1))}return n}const N=Object.freeze([1200,600,300,0]);function T(e,t){return"function"===typeof e?e(t):e}function j(e,t){return"undefined"!==typeof e?T(e,t):void 0}function z(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=j(e,t);return Math.round(Math.max(void 0===r?function(e,t){const n=N.findIndex((e=>e<=t));return T(e[n>=0?n:0],t)}(n,t):r,o))}function B(e){const{photos:t,layout:n,renderContainer:r,defaultContainerWidth:i,breakpoints:a}=e,{containerRef:s,containerWidth:l}=function(e,t){const[{containerWidth:n},r]=o.useReducer($,{containerWidth:t}),i=o.useRef(null),a=o.useRef();return{containerRef:o.useCallback((t=>{var n;null==(n=a.current)||n.disconnect(),a.current=void 0,i.current=t;const o=()=>r({newContainerWidth:S(i.current,e),newScrollbarWidth:window.innerWidth-document.documentElement.clientWidth});o(),t&&"undefined"!==typeof ResizeObserver&&(a.current=new ResizeObserver(o),a.current.observe(t))}),[e]),containerWidth:n}}(function(e){const t=o.useRef(e);return e&&t.current&&e.join()===t.current.join()||(t.current=e),t.current}(a),i);if(!n||!["rows","columns","masonry"].includes(n)||!Array.isArray(t))return null;const c=l?function(e){let{layout:t,onClick:n,containerWidth:o,targetRowHeight:r,rowConstraints:i,columns:a,spacing:s,padding:l,sizes:c}=e;return{layout:t,onClick:n,containerWidth:o,columns:z(a,o,[5,4,3,2],1),spacing:z(s,o,[20,15,10,5]),padding:z(l,o,[0,0,0,0,0]),targetRowHeight:z(r,o,[e=>e/5,e=>e/4,e=>e/3,e=>e/2]),rowConstraints:j(i,o),sizes:c}}({containerWidth:l,...e}):void 0,u=function(e,t,n){const{photos:o,componentsProps:r}=e,i=T(r,t)||{};if(n){const{layout:e,spacing:t,padding:r,rowConstraints:a}=n;if("rows"===e){const{singleRowMaxHeight:e}=a||{};if(e){const n=Math.floor(o.reduce(((t,n)=>{let{width:o,height:i}=n;return t+o/i*e-2*r}),r*o.length*2+t*(o.length-1)));n>0&&(i.containerProps=i.containerProps||{},i.containerProps.style={maxWidth:n,...i.containerProps.style})}}}return i}(e,l,c);return o.createElement(D,{layout:n,containerRef:s,renderContainer:r,containerProps:u.containerProps},c&&function(e,t,n){const{photos:r,layout:i,renderPhoto:a,renderRowContainer:s,renderColumnContainer:l}=e,c={photos:r,renderPhoto:a,componentsProps:t};return"rows"===i?o.createElement(C,{layoutOptions:n,renderRowContainer:s,...c}):"columns"===i?o.createElement(M,{layoutOptions:n,renderColumnContainer:l,...c}):o.createElement(O,{layoutOptions:n,renderColumnContainer:l,...c})}(e,u,c))}var H=n(61263),F=n(94574),G=n(43216),J=n(30456),L=n(15830),V=n(60068),q=n(92073),U=n(58144),X=n(64741),K=n(56318),Y=n(71149),Q=n(34107),Z=(n(49415),n(67531),n(50475),n(88783),n(75361),n(75545),n(69951),n(46413),n(9409),n(24489),n(5354),n(98272),n(65780),n(55615),n(40262),n(22175)),ee=(n(780),n(71346),n(79428),n(33547),n(69350),n(17192),n(16206),n(30966),n(56552),n(21698),n(60474),n(10881),n(74752),n(65620),n(45292),n(71246),n(33260),n(91400),n(87268),n(95445),n(60700),n(14161),n(77932),n(52592),n(74586),n(57082),n(78020),n(96188),n(76214),n(70234),n(98757),n(10683),n(4648),n(41730),n(75863),n(18724),n(43414),n(85972),n(32860),n(24367),n(55745),n(37740),n(82570),n(48539),n(39466),n(7817),n(24388)),te=(n(65567),n(73162),n(32520),n(67895),n(75885),n(44048),n(97509),n(71973),n(90595),n(49191),n(90441),n(68265),n(90656),n(47090)),ne=n(28415),oe=n(65113),re=n(8803),ie=n(69215),ae=n(96513),se=n(983),le=n(71566);function ce(e){let{mediaId:t,type:n,onClose:i}=e;const{actions:{deleteMedia:a}}=(0,ae.A)(),{showSnackbar:s}=(0,oe.d)(),{deleteMediaElement:l}=(0,ee.A)((e=>{let{actions:{deleteMediaElement:t}}=e;return{deleteMediaElement:t}})),{deleteElementsByResourceId:c}=(0,se.P)((e=>({deleteElementsByResourceId:e.actions.deleteElementsByResourceId}))),u=(0,r.hb)((async()=>{i();try{await a(t),l({id:t}),c({id:t})}catch(e){(0,Z.Oz)("local_media_deletion",e.message),s({message:(0,J.__)("Failed to delete media item.","web-stories"),dismissible:!0})}}),[a,l,c,t,i,s]),d=(0,J.__)("Delete Image?","web-stories"),p=(0,J.__)("Delete Video?","web-stories"),h=(0,J.__)("You are about to permanently delete this image from your site. The image will appear broken in any content that uses it.","web-stories"),m=(0,J.__)("You are about to permanently delete this video from your site. The video will appear broken in any content that uses it.","web-stories");return o.createElement(le.A,{isOpen:!0,onClose:i,title:"image"===n?d:p,secondaryText:(0,J.__)("Cancel","web-stories"),onPrimary:u,primaryText:(0,J.__)("Delete","web-stories"),maxWidth:512},o.createElement(re.E.Paragraph,{size:ie.$.Small},"image"===n?h:m),o.createElement(re.E.Paragraph,{size:ie.$.Small,isBold:!0},(0,J.__)("This action can not be undone.","web-stories")))}var ue=n(53906),de=n(4869),pe=n(93473),he=n(11676);const me=(0,F.AH)(["display:flex;width:","px;margin-right:28px;"],152),ge=F.Ay.img.withConfig({displayName:"mediaEditDialog__Image",componentId:"sc-ctku7j-0"})(["",""],me),ye=F.Ay.video.withConfig({displayName:"mediaEditDialog__Video",componentId:"sc-ctku7j-1"})(["",""],me),fe=F.Ay.div.withConfig({displayName:"mediaEditDialog__DialogBody",componentId:"sc-ctku7j-2"})(["display:flex;justify-content:left;align-items:flex-start;"]),we=F.Ay.div.withConfig({displayName:"mediaEditDialog__MetadataTextContainer",componentId:"sc-ctku7j-3"})(["display:flex;flex-direction:column;margin:0 4px;"]),be=(0,F.Ay)(re.E.Span).withConfig({displayName:"mediaEditDialog__DateText",componentId:"sc-ctku7j-4"})(["margin-bottom:8px;"]),Ce=(0,F.Ay)(he.A).withConfig({displayName:"mediaEditDialog__AssistiveTextArea",componentId:"sc-ctku7j-5"})(["margin:20px 0 4px;"]),Ee=(0,J.__)("Edit Image","web-stories"),xe=(0,J.__)("Edit Video","web-stories"),ve=(0,J.__)("Assistive text","web-stories"),_e=(0,J.__)("Video description","web-stories"),ke=(0,J.__)("Describe the appearance and function of the image. Leave empty if the image is purely decorative.","web-stories"),Ae=(0,J.__)("For indexability and accessibility. Include any burned-in text inside the video.","web-stories");function Ie(e){let{resource:t,onClose:n}=e;const{id:i,src:a,creationDate:s,width:l,height:c,type:u,alt:d,poster:p,mimeType:h}=t,{actions:{updateMedia:m}}=(0,ae.A)(),{updateMediaElement:g}=(0,ee.A)((e=>{let{actions:{updateMediaElement:t}}=e;return{updateMediaElement:t}})),{showSnackbar:y}=(0,oe.d)(),[f,w]=(0,r.J0)(d),b=(0,ue.ay)(s),C=(0,r.hb)((e=>{w(e.target.value)}),[]),E=(0,r.hb)((async()=>{try{await m(i,{altText:f}),g({id:i,data:{alt:f}}),n()}catch(e){(0,Z.Oz)("local_media_edit",e.message),y({message:(0,J.__)("Failed to update, please try again.","web-stories"),dismissible:!0})}}),[f,i,n,y,m,g]),x="image"===u;return o.createElement(le.A,{isOpen:!0,onClose:n,title:x?Ee:xe,secondaryText:(0,J.__)("Cancel","web-stories"),onPrimary:E,primaryText:(0,J.__)("Save","web-stories")},o.createElement(fe,null,"image"===u?o.createElement(ge,{src:(0,pe.A)(152,t),alt:d,loading:"lazy",crossOrigin:"anonymous",decoding:"async"}):o.createElement(ye,{key:a,crossOrigin:"anonymous",poster:p,preload:"metadata",muted:!0},o.createElement("source",{src:a,type:h})),o.createElement(we,null,(0,ue.fn)(b)&&o.createElement(be,{size:ie.$.XSmall},(0,de.A)((0,J.__)("Uploaded: %s","web-stories"),(0,ue.Yq)(s))),o.createElement(re.E.Span,{size:ie.$.Small},(0,de.A)((0,J.__)("%1$d x %2$d pixels","web-stories"),l,c)),o.createElement(Ce,{value:f,"aria-label":x?ve:_e,type:"text",placeholder:x?ve:_e,onChange:C}),o.createElement(re.E.Paragraph,{size:ie.$.Small},x?ke:Ae))))}const Pe=(0,F.Ay)(te.rA).withConfig({displayName:"dropDownMenu__MoreButton",componentId:"sc-1eq0xdj-0"})(["top:4px;right:4px;"]),Me=F.Ay.div.withConfig({displayName:"dropDownMenu__DropDownContainer",componentId:"sc-1eq0xdj-1"})(["margin-top:10px;"]),Re=F.Ay.div.withConfig({displayName:"dropDownMenu__MenuContainer",componentId:"sc-1eq0xdj-2"})(["z-index:1;"]),Oe=(0,F.AH)(["min-width:160px;margin-top:0;li{display:block;}"]),We="edit",De="delete";function $e(e){let{resource:t,display:n,isMenuOpen:i,onMenuOpen:a,onMenuCancelled:s,onMenuSelected:l,setParentActive:c=U.l}=e;const u=[{options:[{label:(0,J.__)("Edit meta data","web-stories"),value:We},{label:(0,J.__)("Delete from library","web-stories"),value:De}]}],[d,p]=(0,r.J0)(!1),[h,m]=(0,r.J0)(!1),g=(0,r.li)(),y=(0,r.hb)((()=>{s(),g.current?.focus(),c()}),[s,c]),{canTranscodeResource:f}=(0,ee.A)((e=>{let{state:{canTranscodeResource:t}}=e;return{canTranscodeResource:t}})),w=(0,r.hb)((()=>{p(!1),y()}),[p,y]),b=(0,r.hb)((()=>{m(!1),y()}),[m,y]),C=(0,r.Kr)((()=>`list-${(0,q.A)()}`),[]),E=(0,r.Kr)((()=>`button-${(0,q.A)()}`),[]);return f(t)&&o.createElement(Re,null,g.current&&o.createElement(ne.A,{target:g.current}),o.createElement(Pe,{ref:g,onClick:a,"aria-label":(0,J.__)("More","web-stories"),"aria-pressed":i,"aria-haspopup":!0,"aria-expanded":i,"aria-owns":i?C:null,id:E,$display:n,tabIndex:n||i?0:-1},o.createElement(X.A,null)),(n||i)&&o.createElement(K.A,{anchor:g,placement:Y.W.BottomStart,isOpen:i},o.createElement(Me,null,o.createElement(Q.A,{parentId:E,listId:C,handleMenuItemSelect:(e,t)=>{switch(l(),t){case We:m(!0);break;case De:p(!0)}},groups:u,onDismissMenu:y,hasMenuRole:!0,menuStylesOverride:Oe}))),d&&o.createElement(ce,{mediaId:t.id,type:t.type,onClose:w}),h&&o.createElement(Ie,{resource:t,onClose:b}))}var Se=n(1859),Ne=n(77809),Te=n(65431);const je=(0,F.Ay)(re.E.Span).withConfig({displayName:"attribution__StyledText",componentId:"sc-dg18hp-0"})(["color:",";"],(e=>{let{theme:t,active:n}=e;return(0,G.B3)(t.colors.standard.white,n?1:.6)})),ze=F.Ay.a.withConfig({displayName:"attribution__Link",componentId:"sc-dg18hp-1"})(["display:block;position:absolute;left:0;bottom:0;width:100%;padding:8px;background-color:",";text-overflow:ellipsis;overflow:hidden;white-space:nowrap;text-decoration:none;"],(e=>{let{theme:t,active:n}=e;return(0,G.B3)(t.colors.bg.primary,n?.8:.6)})),Be=e=>{let{author:t,url:n}=e;const[i,a]=(0,r.J0)(!1),s=()=>a(!0),l=()=>a(!1);return o.createElement(ze,{title:t,active:i,onPointerEnter:s,onFocus:s,onPointerLeave:l,onBlur:l,href:n,target:"_blank",rel:"noreferrer"},o.createElement(je,{size:ie.$.XSmall},t))};var He=n(98258),Fe=n(32538),Ge=n(80716),Je=n(92414),Le=n(42979);function Ve(){return Ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ve.apply(this,arguments)}const qe=(0,F.AH)(["width:100%;cursor:pointer;transition:0.2s transform,0.15s opacity;border-radius:4px;opacity:0;object-fit:cover;"]),Ue=F.Ay.img.withConfig({displayName:"innerElement__Image",componentId:"sc-qkk7ov-0"})(["",""],qe),Xe=F.Ay.video.withConfig({displayName:"innerElement__Video",componentId:"sc-qkk7ov-1"})([""," ",""],qe,(e=>{let{showWithoutDelay:t}=e;return t?"opacity: 1;":""})),Ke=F.Ay.div.withConfig({displayName:"innerElement__DurationWrapper",componentId:"sc-qkk7ov-2"})(["position:absolute;bottom:8px;left:8px;background:",";border-radius:100px;height:18px;padding:0 6px;"],(e=>{let{theme:t}=e;return t.colors.opacity.black64})),Ye=F.Ay.div.withConfig({displayName:"innerElement__MuteWrapper",componentId:"sc-qkk7ov-3"})(["position:absolute;bottom:8px;right:8px;height:24px;width:24px;background:",";color:",";border-radius:100px;"],(e=>{let{theme:t}=e;return t.colors.opacity.black64}),(e=>{let{theme:t}=e;return t.colors.fg.primary})),Qe=(0,F.Ay)(re.E.Span).attrs({size:ie.$.XSmall}).withConfig({displayName:"innerElement__Duration",componentId:"sc-qkk7ov-4"})(["color:",";display:block;"],(e=>{let{theme:t}=e;return t.colors.fg.primary})),Ze=F.Ay.img.withConfig({displayName:"innerElement__CloneImg",componentId:"sc-qkk7ov-5"})(["opacity:0;width:",";height:",";position:absolute;"],(e=>{let{width:t}=e;return`${t}px`}),(e=>{let{height:t}=e;return`${t}px`}));var et=(0,r.ph)((function(e){let{type:t,src:n,resource:i,alt:a,width:s,height:l,onClick:c,onLoad:u=U.l,showVideoDetail:d,mediaElement:p,active:h,isMuted:m}=e;const g=(0,r.li)(null),y=(0,r.li)(null),{handleDrag:f,handleDrop:w}=(0,Je.A)((e=>{let{state:t,actions:n}=e;return{handleDrag:n.handleDrag,handleDrop:n.handleDrop,dropTargets:t.dropTargets,activeDropTargetId:t.activeDropTargetId}}),((e,t)=>{if(y.current)return!1;if(null===y.current)return y.current=!1,!1;if(e?.dropTargets&&t?.dropTargets){const n=Object.keys(e.dropTargets),o=Object.keys(t.dropTargets);if(n.join()!==o.join())return!1}return e?.activeDropTargetId===t?.activeDropTargetId})),{setDraggingResource:b}=(0,Je.A)((e=>{let{actions:{setDraggingResource:t}}=e;return{setDraggingResource:t}}));let C;(0,r.vJ)((()=>{i.poster&&(g.current=i.poster)}),[i.poster]);const{lengthFormatted:E,poster:x,mimeType:v}=i,_=x??g.current,k=_||(0,pe.A)(s,i),A={width:s,height:l,alt:a,crossOrigin:"anonymous"},I={...A,onLoad:()=>{p.current&&(p.current.style.opacity=1),u()},loading:"lazy",decoding:"async",draggable:!1},P={...I,onLoad:void 0},M={...I,src:k},R={...A,title:a,alt:null,loop:t===Se.cM.Gif,muted:!0,preload:"metadata",poster:_,showWithoutDelay:h};if(t===Se.cM.Image||t===Se.cM.Sticker?(C=o.createElement(Ue,Ve({key:n},M,{ref:p})),P.src=k):[Se.cM.Video,Se.cM.Gif].includes(t)&&(C=o.createElement(o.Fragment,null,x&&!h?o.createElement(Ue,Ve({key:n},M,{ref:p})):o.createElement(Xe,Ve({key:n},R,{ref:p}),t===Se.cM.Gif?i.output.src&&o.createElement("source",{src:i.output.src,type:i.output.mimeType}):o.createElement("source",{src:(0,pe.A)(s,i),type:v})),t===Se.cM.Video&&d&&E&&o.createElement(Ke,null,o.createElement(Qe,null,E)),t===Se.cM.Video&&d&&m&&o.createElement(Ye,null,o.createElement(Fe.A,null))),P.src=x),!C)throw new Error("Invalid media element type.");const O=t===Se.cM.Image?k:x;return o.createElement(o.Fragment,null,C,h&&o.createElement(Le.A,{showIcon:!1}),o.createElement(Ge.A,{active:h,handleDrag:e=>{y.current||(He.A.set(i.id,{url:k,type:"cached"}),b(i),y.current=!0),f(i,e.clientX,e.clientY)},handleDragEnd:()=>{w(i),y.current=!1},type:i.type,elementProps:{resource:i},onClick:c(O),cloneElement:Ze,cloneProps:P}))})),tt=n(61211),nt=n(81796),ot=n(97572),rt=n(99080),it=n(20322);const at=F.Ay.div.withConfig({displayName:"insertionMenu__DropDownContainer",componentId:"sc-xjd4tf-0"})(["margin-top:10px;min-width:160px;"]),st=F.Ay.div.withConfig({displayName:"insertionMenu__MenuContainer",componentId:"sc-xjd4tf-1"})(["z-index:1;"]),lt=(0,F.AH)(["min-width:160px;margin-top:0;li{display:block;}"]),ct="insert",ut="addBackground";function dt(e){let{resource:t,display:n,onInsert:i,width:a,index:s,isLocal:l=!1,setParentActive:c=U.l,setParentInactive:u=U.l}=e;const d=(0,r.li)(),[p,h]=(0,r.J0)(!1),m=(0,r.hb)((e=>{e.stopPropagation(),h(!0)}),[]),g=(0,r.hb)((()=>{h(!1),d.current?.focus(),c()}),[c]),{currentBackgroundId:y,combineElements:f}=(0,se.P)((e=>({currentBackgroundId:e.state.currentPage?.elements?.[0]?.id,combineElements:e.actions.combineElements}))),{type:w,poster:b}=t,C=[{options:[{label:["image","gif"].includes(w)?(0,J.__)("Insert image","web-stories"):(0,J.__)("Insert video","web-stories"),value:ct},{label:(0,J.__)("Add as background","web-stories"),value:ut}]}];(0,rt.A)({ref:d},[],3);const E=(0,it.A)();(0,tt._h)(l?null:d,"tab",E,[E]);const x=(0,r.Kr)((()=>`list-${(0,q.A)()}`),[]),v=(0,r.Kr)((()=>`button-${(0,q.A)()}`),[]);return o.createElement(st,null,o.createElement(te.rA,{ref:d,onClick:m,"aria-label":(0,J.__)("Open insertion menu","web-stories"),"aria-pressed":p,"aria-haspopup":!0,"aria-expanded":p,"aria-owns":p?x:null,id:v,$display:n,tabIndex:0===s?0:-1},o.createElement(nt.A,null)),p&&o.createElement(K.A,{anchor:d,placement:Y.W.BottomStart,isOpen:p},o.createElement(at,null,o.createElement(Q.A,{parentId:v,listId:x,handleMenuItemSelect:(e,n)=>{const o=b||(0,pe.A)(a,t),r=(0,ot.A)(t.type,{resource:t});switch(h(!1),n){case ct:i(t,o);break;case ut:f({firstElement:r,secondId:y})}u()},groups:C,onDismissMenu:g,hasMenuRole:!0,menuStylesOverride:lt}))))}function pt(){return pt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},pt.apply(this,arguments)}const ht=F.Ay.div.attrs((e=>({style:{width:e.width+"px",height:e.height+"px",margin:e.margin,backgroundColor:"transparent",color:"inherit",border:"none",padding:0}}))).withConfig({displayName:"mediaElement__Container",componentId:"sc-n7038j-0"})([""]),mt=F.Ay.div.withConfig({displayName:"mediaElement__InnerContainer",componentId:"sc-n7038j-1"})(["position:relative;display:flex;margin-bottom:10px;background-color:",";"],(e=>{let{theme:t,$baseColor:n}=e;return n||(0,G.B3)(t.colors.standard.black,.3)})),gt=(0,F.Ay)(V.Q).withConfig({displayName:"mediaElement__BlurhashContainer",componentId:"sc-n7038j-2"})(["position:absolute !important;top:0;left:0;"]);function yt(e){let{index:t,resource:n,width:i,height:a,margin:s,onInsert:l,providerType:c,canEditMedia:u}=e;const{id:d,src:p,type:h,width:m,height:g,alt:y,isMuted:f,baseColor:w,blurHash:b}=n,{isCurrentResourceProcessing:C,isCurrentResourceUploading:E}=(0,ee.A)((e=>{let{state:t}=e;return{isCurrentResourceProcessing:t.isCurrentResourceProcessing,isCurrentResourceUploading:t.isCurrentResourceUploading}})),x=m&&g?m/g:1,v=i||a/x,_=a||v/x,k=(0,r.li)(),[A,I]=(0,r.J0)(!0),[P,M]=(0,r.J0)(!1),[R,O]=(0,r.J0)(!1),[W,D]=(0,r.J0)(!1),$=(0,r.hb)((()=>M(!0)),[]),S=(0,r.hb)((()=>M(!1)),[]),N=(0,r.hb)((()=>O(!0)),[]),T=(0,r.hb)((()=>O(!1)),[]),j=(0,r.hb)((()=>{O(!1),M(!1)}),[]),[z,B]=(0,r.J0)(null),H=(0,r.li)(P);H.current=P,(0,r.vJ)((()=>{if(![Se.cM.Video,Se.cM.Gif].includes(h))return;const e=()=>{null!==z&&(clearTimeout(z),B(null))};if(!R)if(P){if(I(!1),k.current&&null===z){const e=setTimeout((()=>{H.current&&p&&k.current.play().catch(Te.l)}),600);B(e)}}else I(!0),e(),k.current&&k.current?.pause&&p&&(k.current.pause(),k.current.currentTime=0);return e}),[R,P,h,p,z,B,H]);const F=(0,r.hb)((e=>()=>{l(n,e)}),[l,n]),G=P&&n.attribution?.author?.displayName&&n.attribution?.author?.url&&o.createElement(Be,{author:n.attribution.author.displayName,url:n.attribution.author.url}),V=(0,r.li)(),q=(0,r.hb)((()=>D(!0)),[]),U=!W&&!P;return o.createElement(ht,{ref:V,"data-testid":`mediaElement-${h}`,"data-id":d,className:"mediaElement",width:v,height:_,margin:s,onPointerEnter:$,onFocus:$,onPointerLeave:S,onBlur:S,tabIndex:"-1"},o.createElement(mt,{$baseColor:U&&w},o.createElement(et,{type:h,src:p,mediaElement:k,resource:n,alt:y,isMuted:f,width:v,height:_,onClick:F,onLoad:q,showVideoDetail:A,active:P}),G,U&&b&&o.createElement(gt,{hash:b,width:v,height:_,punch:1}),(!p||C(d)||E(d))&&o.createElement(L.G,{loadingMessage:(0,J.__)("Uploading media\u2026","web-stories")}),o.createElement(dt,{resource:n,display:P,onInsert:l,width:v,index:t,isLocal:"local"===c,setParentActive:$,setParentInactive:S}),"local"===c&&u&&o.createElement($e,{resource:n,display:P,isMenuOpen:R,onMenuOpen:N,onMenuCancelled:T,onMenuSelected:j,setParentActive:$})))}var ft=(0,r.ph)((function(e){let{providerType:t="local",canEditMedia:n=!1,...r}=e;const{isCurrentResourceProcessing:i,isCurrentResourceUploading:a}=(0,ee.A)((e=>{let{state:t}=e;return{isCurrentResourceProcessing:t.isCurrentResourceProcessing,isCurrentResourceUploading:t.isCurrentResourceUploading}})),{id:s}=r.resource;return i(s)||a(s)?o.createElement(Ne.A,{title:(0,J.__)("Uploading media\u2026","web-stories")},o.createElement(yt,pt({},r,{providerType:t,canEditMedia:n}))):o.createElement(yt,pt({},r,{providerType:t,canEditMedia:n}))})),wt=n(36673);const bt={maxPhotos:2},Ct=e=>{let{children:t,containerRef:n}=e;return o.createElement(wt.WW,{ref:n},t)},Et=e=>{let{children:t}=e;return t};function xt(e){let{resources:t,uploadingResources:n=[],onInsert:i,providerType:a,canEditMedia:s=!1}=e;const l=[...n.map((e=>({key:`uploading-${e.id}`,src:e.src,width:e.width,height:e.height,resource:e}))),...t.map((e=>({key:e.id,src:e.src,width:e.width,height:e.height,resource:e})))].map(((e,t)=>({...e,index:t}))),c=(0,r.hb)((e=>{let{photo:t,layout:n}=e;return o.createElement(ft,{key:t.key,index:t.index,margin:"0px 0px 8px 0px",resource:t.resource,width:n.width,height:n.height,onInsert:i,providerType:a,canEditMedia:s})}),[a,i,s]);return o.createElement("div",null,o.createElement(B,{layout:"rows",photos:l,renderPhoto:c,renderRowContainer:Et,renderContainer:Ct,targetRowHeight:110,rowConstraints:bt,spacing:8,defaultContainerWidth:H.gH}))}}}]);
//# sourceMappingURL=7843.0d1c9f04.chunk.js.map